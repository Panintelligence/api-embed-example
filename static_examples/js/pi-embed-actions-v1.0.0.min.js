(()=>{var o=class r{constructor(e){this.name=e.name}static SHOW_ALL=new r({name:"SHOW_ALL"});static CONTENT=new r({name:"CONTENT"});static all(){return[r.SHOW_ALL,r.CONTENT]}static validate(e){return r.all().some(t=>t.name===e)}};var a={};a.sendMessage=(r,e,t,i)=>{r.contentWindow.postMessage({action:e,itemId:t},i)};a.validateUrl=r=>{if(!r)return!1;try{let e=new URL(r);if(!e.protocol||!e.host)return!1;let t=e.searchParams.get("editorDisplayMode");return t?o.validate(t):!0}catch{return!1}};a.onIframeLoadComplete=(r,e,t,i)=>{let n=m=>{m.data&&m.data.type===r&&t.contentWindow===m.source&&(e||(i(),window.removeEventListener("message",n)))};window.addEventListener("message",n,!1)};a.runInIframe=(r,e,t,i,n)=>{r?i():(e.setAttribute("src",t),a.onIframeLoadComplete("dashboard-load-complete",r,e,()=>{n(),i()}))};var s=a;var d=class{iframe=null;dashboardUrl=null;assignInitialStateFn=null;constructor(e,t,i){this.iframe=e,this.dashboardUrl=t,this.assignInitialStateFn=i}open(e,t){this.runInIframe(e,()=>{s.sendMessage(this.iframe,"open-report-editor",t,this.dashboardUrl)})}runInIframe(e,t){let i=`${this.dashboardUrl}#/dashboard-system/#/dashboardDesigner`;s.runInIframe(e,this.iframe,i,t,this.assignInitialStateFn)}};var l=class r{iframe=null;iframeId=null;dashboardUrl=null;internalReportEditor=null;hasLoaded=!1;assignInitialStateFn=()=>{this.hasLoaded=!0};static createDashboard(e,t){return new r(e,t)}constructor(e,t){if(!e)throw new Error("iframeId is required to initialise the dashboard.");if(!t)throw new Error("dashboardUrl is required to initialise the dashboard.");if(!s.validateUrl(t))throw new Error(`Invalid dashboard url: ${t}. Please consult the documentation for the expected URL structure.`);let i=document.getElementById(e);if(!i)throw new Error(`Iframe with id "${e}" not found.`);this.iframe=i,this.iframeId=e,this.dashboardUrl=t,this.internalReportEditor=new d(i,t,this.assignInitialStateFn)}reportEditor={open:e=>{this.internalReportEditor.open(this.hasLoaded,e)}}};typeof window<"u"&&(window.PiEmbedActions=l);})();
